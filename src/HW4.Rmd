---
title: "fuckthishit"
author: "Sachiko Lamen"
date: "5/19/2022"
output: html_document
---

```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(janitor)
library(here)
```

```{r}
# Read in data
damage <- read_csv(here("data", "damages.csv"))
warming <- read_csv(here("data", "warming.csv"))
```
### Background Info
The first, “damages.csv” provides new model estimates of the annual total damages from climate change at different levels of warming (in degrees C). The second dataset, “warming.csv” contains estimates of a baseline future climate trajectory (in degrees C) until 2100, and a second trajectory that adds a one-time pulse of CO2 today to the atmosphere. The pulse is 35 billion tons of carbon, which is roughly equal to annual global emissions. You can think of this as a “small” one-time pulse in carbon emissions.

### Questions
1. Using damages.csv, estimate a quadratic damage function relating the dollar value of damages to the change in global mean temperature. Estimate a model with a zero intercept because damages by construction must equal zero when there is no climate change. Plot your estimated damage function, overlaid with a scatterplot of the underlying data.

```{r}
# first write a formula for the regression (we will use again later for cross validation)

damages.lm <- lm(damages ~ warming, data = damage)
damages.slope <- damages.lm$coefficient[2]
damages.intercept <- damages.lm$coefficient[1]
vector_damages <- seq(0, 20, length.out = 556)
damage$damages_equation = damages.slope*(vector_damages) + damages.intercept

baseline.lm <- lm(warming_baseline ~ year, data = warming)
baseline.slope <- baseline.lm$coefficient[2]
baseline.intercept <- baseline.lm$coefficients[1]
vector_baseline <- seq(0, 4, length.out = 79)
warming$baseline_equation = baseline.slope*(vector_baseline) + baseline.intercept


pulse.lm <- lm(warming_pulse ~ year, data = warming)
pulse.slope <- pulse.lm$coefficient[2]
pulse.intercept <- pulse.lm$coefficients[1]
vector_pulse <- seq(0, 4, length.out = 79)
warming$pulse_equation = pulse.slope*(vector_pulse) + pulse.intercept

```

